<div class="wrapper">
    <input type="hidden" class="tabstoggle" name="attr_sheetTab" value="pilot"/>
    <div>
        <button type="action" name="act_pilot" class="tabs">Pilot</button>
        <button type="action" name="act_mech" class="tabs">Mech</button>
    </div>

    <div class="pilot">
        <h2>Pilot <button type="roll" value="&{template:roll}{{name=@{character_name}}}{{roll=[[1d20]]}}"></button></h2>
        <div style="display: flex;">
            <div class="twocolumns">
                <div class="labels">
                    <label>Callsign</label>
                    <label>Background </label>
                    <label>Ideal </label>
                    <label>Flaw </label>
                    <label>Keepsake </label>
                    <label>Motto </label>
                </div>
                <div class="valuecolumn">
                    <input type="text" name="attr_character_name">
                    <input type="text" name="attr_background">
                    <input type="text" name="attr_ideal">
                    <input type="text" name="attr_flaw">
                    <input type="text" name="attr_keepsake">
                    <input type="text" name="attr_motto">
                </div>
            </div>

            <div class="marginleft">
                <h3>Stats</h3>
                <div class="twocolumns">
                    <div class="labels">
                        <label>Health</label>
                        <label>Ability Pts </label>
                        <label>Stress </label>
                    </div>
                    <div class="valuecolumn">
                        <input type="number" min="0" max="10" name="attr_health" value="10">
                        <input type="number" min="0" max="5" name="attr_abilitypts" value="5">
                        <input type="number" min="0" max="10" name="attr_stress" value="0">
                    </div>
                    <div>
                        <label> of 10</label>
                        <label> of 5</label>
                        <label> of 10 </label>
                    </div>
                </div>
            </div>
        </div>

        <h3>Weapons</h3>
        <div class="weapon">
            <label>Name</label>
            <label>Range</label>
            <label>Damage</label>
        </div>
        <div>
            <fieldset class="repeating_weapons">
                <div class="weapon">
                    <input type="text" name="attr_weaponname" title="Name of the Weapon">
                    <input type="text" name="attr_range" title="Range">
                    <input type="text" name="attr_damage" title="Damage">
                    <button type="roll" title="Fire the Weapon" value="&{template:weapon}{{callsign=@{character_name}}}{{range=@{range}}}{{weapon_name=@{weaponname}}}{{roll=[[1d20]]}}{{damage=@{damage}}}">
                    </button>
                </div>
            </fieldset>
        </div>

        <h3>Inventory</h3>
        <div>
            <input type="text" name="attr_itemname1">
            <input type="text" name="attr_itemname2">
            <input type="text" name="attr_itemname3">
            <input type="text" name="attr_itemname4">
            <input type="text" name="attr_itemname5">
            <input type="text" name="attr_itemname6">
        </div>

        <h3>Equipment</h3>
        <fieldset class="repeating_equipment">
            <textarea name="attr_equipment" class="textarea"></textarea>
        </fieldset>

        <h3>Abilities</h3>
        <fieldset class="repeating_abilities">
            <textarea name="attr_ability" class="textarea"></textarea>
        </fieldset>

    </div>

    <div class="mech">
        <h2>Mech <button type="roll" value="&{template:roll}{{name=@{mechname}}}{{roll=[[1d20]]}}"></button></h2>
        <div style="display: flex;">
            <div class="twocolumns">
                <div class="labels">
                    <label>Name</label>
                    <label>System Slots </label>
                    <label>Module Slots </label>
                    <label>Chassis Type </label>
                </div>
                <div class="valuecolumn">
                    <input type="text" name="attr_mechname">
                    <input type="text" name="attr_system">
                    <input type="text" name="attr_module">
                    <input type="text" name="attr_chassis">
                </div>
            </div>

            <div class="marginleft">
                <h3>Stats</h3>
                <div class="twocolumns">
                    <div class="labels">
                        <label>Structure</label>
                        <label>Energy Pts </label>
                        <label>Heat </label>
                    </div>
                    <div class="valuecolumn">
                        <input type="number" min="0" name="attr_structure" value="10">
                        <input type="number" min="0" name="attr_energy" value="10">
                        <input type="number" min="0" max="10" name="attr_heat" value="0">
                    </div>
                    <div>
                        <label> of  <input type="number" min="0" name="attr_structure_max" value="10"></label>
                        <label> of  <input type="number" min="0" name="attr_energy_max" value="10"></label>
                        <label> of  <input type="number" min="0" name="attr_heat_max" value="10"> </label>
                    </div>
                </div>
            </div>
        </div>

        <h3>Weapons</h3>
        <div class="weapon">
            <label>Name</label>
            <label>Range</label>
            <label>Damage</label>
        </div>
        <div>
            <fieldset class="repeating_mechweapons">
                <div class="weapon">
                    <input type="text" name="attr_weaponname" title="Name of the Weapon">
                    <input type="text" name="attr_range" title="Range">
                    <input type="text" name="attr_damage" title="Damage">
                    <button type="roll" title="Fire the Weapon" value="&{template:weapon}{{callsign=@{mechname}}}{{range=@{range}}}{{weapon_name=@{weaponname}}}{{roll=[[1d20]]}}{{damage=@{damage}}}">
                    </button>
                </div>
            </fieldset>
        </div>

        <h3>Cargo</h3>
        <fieldset class="repeating_cargo">
            <textarea name="attr_cargo" class="textarea"></textarea>
        </fieldset>

        <h3>Modules</h3>
        <fieldset class="repeating_modules">
            <textarea name="attr_module" class="textarea"></textarea>
        </fieldset>

        <h3>Systems</h3>
        <fieldset class="repeating_systems">
            <textarea name="attr_system" class="textarea"></textarea>
        </fieldset>
    </div>
</div>


<script type="text/worker">
    const buttonlist = ["pilot","mech"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });
</script>

<rolltemplate class="sheet-rolltemplate-weapon">
    <table>
        <tr>
            <th>
                {{callsign}} rolls an attack on range {{range}} with {{weapon_name}}
            </th>
        </tr>
        <tr>
            <td>
                <div class="sheet-rolltemplate-spacer"></div>
            </td>
        </tr>
        <tr>
            <td>
                {{#rollBetween() roll 20 20}}
                <strong>Nailed it</strong> ({{roll}}) <br>
                You have overcome the odds and managed an outstanding success. You may achieve an additional bonus of your choice to the action. When dealing damage you double it.
                {{/rollBetween() roll 20 20}}

                {{#rollBetween() roll 11 19}}
                Success ({{roll}}) - You’ve achieved your goal without any compromises. When attacking you hit the target and deal standard damage
                {{/rollBetween() roll 11 19}}

                {{#rollBetween() roll 6 10}}
                Tough Choice ({{roll}}) - You succeed in your action but at a cost. The Mediator will give you a tough choice with some kind of consequence. When attacking you hit but something has
                gone wrong.
                {{/rollBetween() roll 6 10}}

                {{#rollBetween() roll 2 5}}
                Failure ({{roll}}) - You’ve failed at what you were attempting, and you’ll face a consequence of The Mediator’s choice. When attacking you miss the target.
                {{/rollBetween() roll 2 5}}

                {{#rollBetween() roll 1 1}}
                Cascade Failure ({{roll}}) - You have not only failed, but something has gone terribly wrong. You will suffer a severe consequence of The Mediator’s choice. When attacking you miss the
                target and something has gone wrong.
                {{/rollBetween() roll 1 1}}
            </td>
        </tr>
        <tr>
            <td>
                <div class="sheet-rolltemplate-spacer"></div>
            </td>
        </tr>
        <tr>
            <td>
                Weapondamage: {{damage}}
            </td>
        </tr>
    </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-roll">
    <table>
        <tr>
            <th>
                {{name}} rolls
            </th>
        </tr>
        <tr>
            <td>
                <div class="sheet-rolltemplate-spacer"></div>
            </td>
        </tr>
        <tr>
            <td>
                {{#rollBetween() roll 20 20}}
                <strong>Nailed it</strong> ({{roll}}) <br>
                You have overcome the odds and managed an outstanding success. You may achieve an additional bonus of your choice to the action. When dealing damage you double it.
                {{/rollBetween() roll 20 20}}

                {{#rollBetween() roll 11 19}}
                Success ({{roll}}) - You’ve achieved your goal without any compromises. When attacking you hit the target and deal standard damage
                {{/rollBetween() roll 11 19}}

                {{#rollBetween() roll 6 10}}
                Tough Choice ({{roll}}) - You succeed in your action but at a cost. The Mediator will give you a tough choice with some kind of consequence. When attacking you hit but something has
                gone wrong.
                {{/rollBetween() roll 6 10}}

                {{#rollBetween() roll 2 5}}
                Failure ({{roll}}) - You’ve failed at what you were attempting, and you’ll face a consequence of The Mediator’s choice. When attacking you miss the target.
                {{/rollBetween() roll 2 5}}

                {{#rollBetween() roll 1 1}}
                Cascade Failure ({{roll}}) - You have not only failed, but something has gone terribly wrong. You will suffer a severe consequence of The Mediator’s choice. When attacking you miss the
                target and something has gone wrong.
                {{/rollBetween() roll 1 1}}
            </td>
        </tr>
    </table>
</rolltemplate>